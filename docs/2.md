# Shell Tools and Scripting

<iframe width="616" height="347" src="https://www.youtube.com/embed/kgII-YWo3Zw" title="Lecture 2: Shell Tools and Scripting (2020)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

In this lecture, we will present some of the basics of using bash as a scripting language along with a number of shell tools that cover several of the most common tasks that you will be constantly performing in the command line.

### Shell Scripting

到目前为止，我们已经了解了如何在 shell 中执行命令，也知道了怎样 pipe them together

但是，在很多场景下，你会希望执行一系列的命令，并同时使用控制流表达式，就比如条件或循环

那么接下来，你就需要学习 shell scripts

大多数的 shell 都有它们自己的 scripting language with variables, control flow and its own syntax

shell 脚本与其他脚本编程语言的不同之处在于，它针对执行与 shell 相关的任务进行了优化

在 shell 脚本中，creating command pipelines, saving results into files, and reading from standard input 这些都是基本操作

因此，相比于其它的通用脚本编程语言，shell scripting 更加易于使用

本节讲座，我们会聚焦于 bash scripting，因为它最常见

---

要在 bash 中定义变量，请使用语法 `foo=bar`，要获取变量 foo 的值，请使用 `$foo`

注意：`foo = bar` will not work，因为它会被 bash 解释为：调用程序 foo 并为其提供参数 = 和 bar

显然这并非我们的意图

通常，在 shell 脚本中，空格用于参数拆分

这种 behavior 可能会给初学者带来困惑，所以不妨认真检查你的 shell 脚本代码

---

在 bash 中，可以使用单引号 `'` 或双引号 `"` 来定义字符串，但二者是有区别的

用单引号包裹的字符串就是普通的文字字符串，不会替换变量值，而使用双引号包裹的字符串会替换变量值

```bash
foo=bar
echo "$foo"
# prints bar
echo '$foo'
# prints $foo
```

和大多数编程语言一样，bash 支持控制流技术，包括：`if`、`case`、`while`、`for`

类似地，bash 也有函数，能接收并使用参数

下面是一个函数的例子，该函数能创建并进入文件夹

```bash
mcd () {
    mkdir -p "$1"
    cd "$1"
}
```

在上面这个例子中，`$1` 就是这个 script/function 的第一个参数

和其他的脚本语言不同，bash 使用各种特殊的变量，来引用「参数、错误代码、和其他相关变量」

下面给出了一些特殊的变量，更多的特殊变量可以从[这里](https://tldp.org/LDP/abs/html/special-chars.html)查看

- `$0` - Name of the script
- `$1` to `$9` - Arguments to the script. `$1` is the first argument and so on.
- `$@` - All the arguments
- `$#` - Number of arguments
- `$?` - Return code of the previous command
- `$$` - Process identification number (PID) for the current script
- `!!` - Entire last command, including arguments. A common pattern is to execute a command only for it to fail due to missing permissions; you can quickly re-execute the command with sudo by doing `sudo !!`
- `$_` - Last argument from the last command. If you are in an interactive shell, you can also quickly get this value by typing `Esc` followed by `.` or `Alt+.`

commands 通常会将其 output 输出到 `STDOUT`，将 errors 输出到 `STDERR`

并且会有一个 Return Code 来 report errors，以一种 script-friendly 的方式





### Shell Tools

### Notes on the class

### Exericses after this class




























